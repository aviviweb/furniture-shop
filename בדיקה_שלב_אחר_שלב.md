# 🔍 בדיקה שלב אחר שלב - Database Error

## ❌ השגיאה שאתה רואה:
```
Can't reach database server at ...:5432
errorCode: 'P1001'
```

---

## ✅ בדיקה 1: האם יש PostgreSQL Service?

### איך לבדוק:
1. **Railway Dashboard** → **חזור לרשימת Services** (לחץ על שם הפרויקט למעלה)
2. **חפש Service בשם:**
   - "Postgres"
   - "PostgreSQL"  
   - או כל שם עם "postgres"

### אם אין:
→ **צור אחד:**
1. **לחץ "New"** (למעלה מימין)
2. **"Database"** → **"PostgreSQL"**
3. **חכה 30 שניות**

### אם יש:
→ **עבור לבדיקה 2**

---

## ✅ בדיקה 2: האם PostgreSQL עובד?

### איך לבדוק:
1. **PostgreSQL Service** → **"Logs"** (משמאל)
2. **חפש הודעות:**
   ```
   database system is ready to accept connections
   ```
   או:
   ```
   PostgreSQL init process complete
   ```

### אם אתה רואה את זה:
→ **PostgreSQL עובד!** ✅ → **עבור לבדיקה 3**

### אם לא:
→ **חכה עוד 30 שניות** ובדוק שוב

---

## ✅ בדיקה 3: האם DATABASE_URL מוגדר ב-API Service?

### איך לבדוק:
1. **API Service** (`@furniture/api`) → **"Variables"** (משמאל)
2. **חפש `DATABASE_URL`** (הקלד בחיפוש)
3. **אם יש** → **עבור לבדיקה 4**
4. **אם אין** → **תקן עכשיו!**

### איך לתקן:
1. **PostgreSQL Service** → **"Variables"** (משמאל)
2. **חפש `DATABASE_URL`** → **לחץ עליו** → **העתק** (Ctrl+C)
3. **API Service** → **"Variables"** → **"+ New Variable"**
4. **שם:** `DATABASE_URL`
5. **ערך:** הדבק (Ctrl+V) מה שהעתקת
6. **לחץ "Save"**

---

## ✅ בדיקה 4: האם DATABASE_URL נכון?

### איך לבדוק:
1. **API Service** → **"Variables"** → **`DATABASE_URL`**
2. **לחץ עליו** → **ראה את הערך**

### צריך להיראות כך:
```
postgresql://postgres:PASSWORD@HOST:5432/railway
```

**חשוב:**
- ✅ מתחיל ב-`postgresql://` או `postgres://`
- ✅ מכיל `:5432` (פורט)
- ✅ מכיל שם database (למשל `railway`)

### אם נכון:
→ **עבור לבדיקה 5**

### אם לא נכון:
→ **העתק מ-PostgreSQL Service** (ראה בדיקה 3)

---

## ✅ בדיקה 5: הרץ Migrations

### איך:
1. **API Service** → **"Deployments"** (משמאל)
2. **לחץ "Run Command"** או **"Shell"**
3. **הדבק:**
   ```
   pnpm --filter @furniture/prisma migrate deploy
   ```
4. **Enter** → **חכה לסיום**

### אם יש שגיאה:
→ **העתק את השגיאה** ובדוק מה הבעיה

### אם הצליח:
→ **עבור לבדיקה 6**

---

## ✅ בדיקה 6: Restart

### איך:
1. **API Service** → **לחץ "Restart"** (כפתור אדום למעלה)
2. **חכה 2-3 דקות**
3. **בדוק שוב את ה-Logs**

### אם עדיין יש שגיאה:
→ **חזור לבדיקה 3** (וודא ש-DATABASE_URL מוגדר)

---

## 📋 Checklist:

- [ ] יש PostgreSQL Service בפרויקט
- [ ] PostgreSQL Service במצב "Active" (ירוק)
- [ ] PostgreSQL Logs מראים "ready to accept connections"
- [ ] יש `DATABASE_URL` ב-API Service Variables
- [ ] `DATABASE_URL` מתחיל ב-`postgresql://`
- [ ] `DATABASE_URL` מכיל `:5432`
- [ ] הרצתי Migrations
- [ ] לחצתי Restart
- [ ] בדקתי שוב את ה-Logs

---

## 🆘 עדיין לא עובד?

**שלח לי:**
1. ✅ האם יש PostgreSQL Service? (כן/לא)
2. ✅ האם `DATABASE_URL` מוגדר ב-API Service? (כן/לא)
3. ✅ מה כתוב ב-Logs של PostgreSQL Service? (העתק הודעה אחת)
4. ✅ מה כתוב ב-Logs של API Service? (העתק את השגיאה)

---

**התחל עם בדיקה 1!** 🔍

